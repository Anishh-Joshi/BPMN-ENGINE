<?xml version='1.0' encoding='UTF-8'?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_1" targetNamespace="http://example.com/bpmn">

  <bpmn:process id="UserRegistrationApproval" name="User Registration Approval" isExecutable="true">

    <bpmn:startEvent id="StartEvent" name="Start">
      <bpmn:outgoing>Flow1</bpmn:outgoing>
    </bpmn:startEvent>

    <bpmn:userTask id="Task_UserInput" name="User Registration">
      <bpmn:incoming>Flow1</bpmn:incoming>
      <bpmn:outgoing>Flow2</bpmn:outgoing>
    </bpmn:userTask>

    <bpmn:userTask id="Task_AssigneeApproval" name="Approval by Assignee" camunda:assignee="${assignee}">
      <bpmn:incoming>Flow2</bpmn:incoming>
      <bpmn:outgoing>Flow3</bpmn:outgoing>
    </bpmn:userTask>

    <bpmn:exclusiveGateway id="Gateway_Decision" name="Decision">
      <bpmn:incoming>Flow3</bpmn:incoming>
      <bpmn:outgoing>FlowApproved</bpmn:outgoing>
      <bpmn:outgoing>FlowRejected</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:scriptTask id="Task_Approved" name="Approved">
      <bpmn:incoming>FlowApproved</bpmn:incoming>
      <bpmn:outgoing>FlowEnd</bpmn:outgoing>
      <bpmn:script>
if approved == True:
    is_valid_registration = True
</bpmn:script>
    </bpmn:scriptTask>

    <bpmn:scriptTask id="Task_Rejected" name="Rejected">
      <bpmn:incoming>FlowRejected</bpmn:incoming>
      <bpmn:outgoing>FlowEnd2</bpmn:outgoing>
      <bpmn:script>
if approved == False:
    is_valid_registration = False
</bpmn:script>
    </bpmn:scriptTask>

    <bpmn:endEvent id="EndEvent" name="End">
      <bpmn:incoming>FlowEnd</bpmn:incoming>
      <bpmn:incoming>FlowEnd2</bpmn:incoming>
    </bpmn:endEvent>

    <!-- Sequence Flows -->
    <bpmn:sequenceFlow id="Flow1" sourceRef="StartEvent" targetRef="Task_UserInput"/>
    <bpmn:sequenceFlow id="Flow2" sourceRef="Task_UserInput" targetRef="Task_AssigneeApproval"/>
    <bpmn:sequenceFlow id="Flow3" sourceRef="Task_AssigneeApproval" targetRef="Gateway_Decision"/>
    <bpmn:sequenceFlow id="FlowApproved" sourceRef="Gateway_Decision" targetRef="Task_Approved">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${approved == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="FlowRejected" sourceRef="Gateway_Decision" targetRef="Task_Rejected">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${approved == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="FlowEnd" sourceRef="Task_Approved" targetRef="EndEvent"/>
    <bpmn:sequenceFlow id="FlowEnd2" sourceRef="Task_Rejected" targetRef="EndEvent"/>

  </bpmn:process>
<bpmndi:BPMNDiagram><bpmndi:BPMNPlane bpmnElement="UserRegistrationApproval"><bpmndi:BPMNShape bpmnElement="StartEvent"><dc:Bounds x="100" y="100" width="36" height="36"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="Task_UserInput"><dc:Bounds x="180" y="90" width="100" height="80"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="Task_AssigneeApproval"><dc:Bounds x="320" y="90" width="100" height="80"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="Gateway_Decision"><dc:Bounds x="460" y="105" width="50" height="50"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="Task_Approved"><dc:Bounds x="550" y="30" width="100" height="80"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="Task_Rejected"><dc:Bounds x="550" y="180" width="100" height="80"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement="EndEvent"><dc:Bounds x="700" y="105" width="36" height="36"/></bpmndi:BPMNShape><bpmndi:BPMNEdge bpmnElement="Flow1"><di:waypoint x="136" y="118"/><di:waypoint x="180" y="130"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="Flow2"><di:waypoint x="280" y="130"/><di:waypoint x="320" y="130"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="Flow3"><di:waypoint x="420" y="130"/><di:waypoint x="460" y="130"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="FlowApproved"><di:waypoint x="485" y="105"/><di:waypoint x="550" y="70"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="FlowRejected"><di:waypoint x="485" y="155"/><di:waypoint x="550" y="220"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="FlowEnd"><di:waypoint x="650" y="70"/><di:waypoint x="700" y="123"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement="FlowEnd2"><di:waypoint x="650" y="220"/><di:waypoint x="700" y="123"/></bpmndi:BPMNEdge></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>
